
> simpilot-mvp@0.0.0 test
> vitest src/ingestion/__tests__/toolListParser.test.ts --run


[1m[46m RUN [49m[22m [36mv4.0.14 [39m[90mC:/Users/georgem/source/repos/SimPilot[39m

 [31mÎ“Â¥Â»[39m src/ingestion/__tests__/toolListParser.test.ts [2m([22m[2m35 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 17[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should vacuum unknown columns into metadata[39m[32m 7[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should vacuum columns even if they have special characters[39m[32m 1[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should map "CARRY OVER" to REUSE[32m 1[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should map "Existing" to REUSE[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should map "Retain" to REUSE[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should map "NEW" to NEW_BUY[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should default to UNKNOWN when sourcing is ambiguous[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect sourcing from comments field[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect SPOT_WELD from filename with "wg"[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect SPOT_WELD from type string[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect SEALER from filename[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect GRIPPER from type string[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should default to OTHER for unknown tool types[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect SERVO subtype[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should detect PNEUMATIC subtype[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should default to UNKNOWN subtype when unclear[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should not set subtype for non-spot-weld tools[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should find tool ID from "GUN ID" header[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should find tool ID from "TOOL NAME" header[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should find tool ID from "EQUIPMENT ID" header[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should parse area/line/station from various header names[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should parse partial data without crashing[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should skip rows with no tool ID[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should skip empty rows[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should skip total rows[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should handle null and undefined values gracefully[32m 0[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should warn when no valid tools found[39m[32m 1[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should throw error for workbook with no sheets[32m 1[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should throw error when no valid headers found[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should throw error for sheets with too few rows[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should extract OEM model from various column names[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should try MANUFACTURER column if MODEL not found[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should try SUPPLIER column if MODEL and MANUFACTURER not found[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should capture source file name and sheet name[32m 0[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should capture row index for debugging[32m 0[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 3 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  src/ingestion/__tests__/toolListParser.test.ts > toolListParser - Real-World Resilience > Vacuum Logic: Unknown Columns > should vacuum unknown columns into metadata
AssertionError: expected undefined to be 'Yes' // Object.is equality

- Expected: 
"Yes"

+ Received: 
undefined

 Î“Â¥Â» src/ingestion/__tests__/toolListParser.test.ts:36:57
     34|             // Assert: Unknown columns should be in metadata
     35|             expect(firstTool.metadata).toBeDefined()
     36|             expect(firstTool.metadata['Refresment OK']).toBe('Yes')  /Î“Ã‡Âª
       |                                                         ^
     37|             expect(firstTool.metadata['Coments']).toBe('Issues with tiÎ“Ã‡Âª
     38|             expect(firstTool.metadata['Supplier 2']).toBe('ACME Corp')Î“Ã‡Âª

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/3]Î“Ã„Â»

 FAIL  src/ingestion/__tests__/toolListParser.test.ts > toolListParser - Real-World Resilience > Vacuum Logic: Unknown Columns > should vacuum columns even if they have special characters
AssertionError: expected undefined to be 'Active' // Object.is equality

- Expected: 
"Active"

+ Received: 
undefined

 Î“Â¥Â» src/ingestion/__tests__/toolListParser.test.ts:57:63
     55|             expect(result.tools[0].metadata['Cost ($)']).toBe('25000')
     56|             expect(result.tools[0].metadata['Weight (kg)']).toBe('150')
     57|             expect(result.tools[0].metadata['Status [2024]']).toBe('AcÎ“Ã‡Âª
       |                                                               ^
     58|         })
     59|     })

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/3]Î“Ã„Â»

 FAIL  src/ingestion/__tests__/toolListParser.test.ts > toolListParser - Real-World Resilience > Resilience: Partial & Garbage Data > should warn when no valid tools found
Error: Sheet "Sheet1" has too few rows (1). Expected at least 2 rows.
 Î“Â¥Â» parseToolList src/ingestion/toolListParser.ts:91:11

     89|   const rows = sheetToMatrix(workbook, sheetName)
     90|   if (rows.length < 2) {
     91|     throw new Error(`Sheet "${sheetName}" has too few rows (${rows.lenÎ“Ã‡Âª
       |           ^
     92|   }
     93| 
 Î“Â¥Â» src/ingestion/__tests__/toolListParser.test.ts:350:34

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/3]Î“Ã„Â»

[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m32 passed[39m[22m[90m (35)[39m
[2m   Start at [22m 11:17:44
[2m   Duration [22m 1.02s[2m (transform 94ms, setup 25ms, import 209ms, tests 17ms, environment 604ms)[22m

