
> simpilot-mvp@0.0.0 test
> vitest --run src/excel/__tests__/ src/ingestion/__tests__/


[1m[46m RUN [49m[22m [36mv4.0.14 [39m[90mc:/Users/George/source/repos/SimPilot[39m

 [32mâœ“[39m src/excel/__tests__/fieldRegistry.test.ts [2m([22m[2m37 tests[22m[2m)[22m[32m 47[2mms[22m[39m
 [31mâ¯[39m src/ingestion/__tests__/excelIngestionTypes.test.ts [2m([22m[2m66 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 33[2mms[22m[39m
     [32mâœ“[39m should map Robot to ROBOT[32m 2[2mms[22m[39m
     [32mâœ“[39m should map WeldGun to GUN[32m 0[2mms[22m[39m
     [32mâœ“[39m should map TMSGun to GUN[32m 0[2mms[22m[39m
     [32mâœ“[39m should map Gripper to TOOL[32m 0[2mms[22m[39m
     [32mâœ“[39m should map Fixture to TOOL[32m 0[2mms[22m[39m
     [32mâœ“[39m should map Riser to TOOL[32m 0[2mms[22m[39m
     [32mâœ“[39m should map TipDresser to TOOL[32m 0[2mms[22m[39m
     [32mâœ“[39m should map Measurement to TOOL[32m 0[2mms[22m[39m
     [32mâœ“[39m should map Other to OTHER[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Riser from sheet category[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer TipDresser from sheet category[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer TMSGun from sheet category[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer WeldGun from weld gun sheet category[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer WeldGun from SW application code[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer WeldGun from SPOT application code[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Gripper from MH application code[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Measurement from IM application code[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer WeldGun from gun in name[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Gripper from grip in name[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Riser from riser in name[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Fixture from fixture in name[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer Robot from robot in name[32m 0[2mms[22m[39m
       [32mâœ“[39m should return Other when no hints match[32m 0[2mms[22m[39m
       [32mâœ“[39m should prioritize sheet category over application code[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE when on reuse list[32m 0[2mms[22m[39m
       [32mâœ“[39m should prioritize reuse list over new hints[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE for free issue[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE for free-issue (hyphenated)[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE for FI abbreviation[32m 0[2mms[22m[39m
       [32mâœ“[39m should return NEW_BUY for new marker[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle new at start of text[32m 0[2mms[22m[39m
       [32mâœ“[39m should return MAKE for make marker[32m 0[2mms[22m[39m
       [32mâœ“[39m should return MAKE for custom marker[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE for reuse keyword[32m 0[2mms[22m[39m
       [32mâœ“[39m should return REUSE for carry over[32m 0[2mms[22m[39m
       [32mâœ“[39m should return UNKNOWN when no hints present[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify REAR UNIT internal status file[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify UNDERBODY internal status file[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify FRONT UNIT outsource status file[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify REAR UNIT outsource status file[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify internal RISERS list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify outsource RISERS list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify internal TIP DRESSER list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify outsource TIP DRESSER list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify internal TMS WG list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify outsource TMS WG list[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify internal Rev05 robotlist[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify outsource Rev01 robotlist[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify outsource Rev05 robotlist (duplicate)[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify Zangenpool file[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify ZangenÃ¼bersichtsliste file[32m 0[2mms[22m[39m
       [32mâœ“[39m should return UNKNOWN_WORKBOOK for unrecognized files[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer InternalSimulation from path for unknown files[32m 0[2mms[22m[39m
       [32mâœ“[39m should infer OutsourceSimulation from path for unknown files[32m 0[2mms[22m[39m
     [32mâœ“[39m should build key from minimal data (project + area)[32m 0[2mms[22m[39m
     [32mâœ“[39m should include assembly line when present[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m should include station when present[39m[32m 13[2mms[22m[39m
[31m     [31mÃ—[31m should include robot number when present[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m should include asset name when present[39m[32m 2[2mms[22m[39m
     [32mâœ“[39m should normalize case and trim whitespace[32m 0[2mms[22m[39m
     [32mâœ“[39m should skip null/undefined fields[32m 0[2mms[22m[39m
     [32mâœ“[39m should skip empty string fields[32m 0[2mms[22m[39m
     [32mâœ“[39m should build unique row ID[32m 0[2mms[22m[39m
     [32mâœ“[39m should produce different IDs for different rows[32m 0[2mms[22m[39m
     [32mâœ“[39m should produce different IDs for different sheets[32m 0[2mms[22m[39m
     [32mâœ“[39m should produce different IDs for different workbooks[32m 0[2mms[22m[39m
 [31mâ¯[39m src/ingestion/__tests__/excelIngestionOrchestrator.test.ts [2m([22m[2m10 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 33[2mms[22m[39m
       [32mâœ“[39m should orchestrate full ingestion pipeline[32m 8[2mms[22m[39m
       [32mâœ“[39m should handle errors from reuse list loading[32m 1[2mms[22m[39m
       [32mâœ“[39m should skip reuse lists when loadReuseLists is false[32m 4[2mms[22m[39m
       [32mâœ“[39m should skip linking when attachReuseInfo is false[32m 1[2mms[22m[39m
       [32mâœ“[39m should pass validation for healthy result[32m 1[2mms[22m[39m
       [32mâœ“[39m should warn on high unmatched reuse count[32m 0[2mms[22m[39m
       [32mâœ“[39m should warn on high UNKNOWN allocation status[32m 0[2mms[22m[39m
       [32mâœ“[39m should warn when most assets lack reuse info[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should format result as readable text[39m[32m 13[2mms[22m[39m
       [32mâœ“[39m should handle empty result[32m 0[2mms[22m[39m
 [32mâœ“[39m src/excel/__tests__/engineBridge.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 80[2mms[22m[39m
 [32mâœ“[39m src/excel/__tests__/fieldMatcher.test.ts [2m([22m[2m38 tests[22m[2m)[22m[32m 118[2mms[22m[39m
[90mstderr[2m | src/ingestion/__tests__/workbookLoader.test.ts[2m > [22m[2mloadWorkbookFromBuffer[2m > [22m[2merror handling[2m > [22m[2mreturns empty sheets array for empty buffer
[22m[39m[WorkbookLoader] Empty buffer for empty.xlsx

[90mstderr[2m | src/ingestion/__tests__/workbookLoader.test.ts[2m > [22m[2mloadWorkbookFromBuffer[2m > [22m[2merror handling[2m > [22m[2mreturns empty sheets array for unknown file type
[22m[39m[WorkbookLoader] Unknown file type for unknown.bin

[90mstderr[2m | src/ingestion/__tests__/workbookLoader.test.ts[2m > [22m[2mloadWorkbookFromBuffer[2m > [22m[2merror handling[2m > [22m[2mhandles corrupted xlsx gracefully
[22m[39m[WorkbookLoader] Failed to parse corrupted.xlsx: Error: Unsupported ZIP file
    at parse_zip (C:\Users\George\source\repos\SimPilot\node_modules\[4mxlsx[24m\xlsx.js:23114:9)
    at read_zip (C:\Users\George\source\repos\SimPilot\node_modules\[4mxlsx[24m\xlsx.js:23644:9)
    at readSync (C:\Users\George\source\repos\SimPilot\node_modules\[4mxlsx[24m\xlsx.js:23715:69)
    at Proxy.readSync (C:\Users\George\source\repos\SimPilot\node_modules\[4mxlsx[24m\xlsx.js:23691:79)
    at loadWorkbookFromBuffer (C:/Users/George/source/repos/SimPilot/src/ingestion/workbookLoader.ts:200:21)
    at C:/Users/George/source/repos/SimPilot/src/ingestion/__tests__/workbookLoader.test.ts:183:22
    at file:///C:/Users/George/source/repos/SimPilot/node_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at file:///C:/Users/George/source/repos/SimPilot/node_modules/[4m@vitest[24m/runner/dist/index.js:919:26
    at file:///C:/Users/George/source/repos/SimPilot/node_modules/[4m@vitest[24m/runner/dist/index.js:1244:20
    at new Promise (<anonymous>)

 [31mâ¯[39m src/ingestion/__tests__/toolListParser.test.ts [2m([22m[2m35 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 37[2mms[22m[39m
       [32mâœ“[39m should vacuum unknown columns into metadata[32m 6[2mms[22m[39m
       [32mâœ“[39m should vacuum columns even if they have special characters[32m 1[2mms[22m[39m
       [32mâœ“[39m should map "CARRY OVER" to REUSE[32m 1[2mms[22m[39m
       [32mâœ“[39m should map "Existing" to REUSE[32m 1[2mms[22m[39m
       [32mâœ“[39m should map "Retain" to REUSE[32m 1[2mms[22m[39m
       [32mâœ“[39m should map "NEW" to NEW_BUY[32m 1[2mms[22m[39m
       [32mâœ“[39m should default to UNKNOWN when sourcing is ambiguous[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect sourcing from comments field[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect SPOT_WELD from filename with "wg"[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect SPOT_WELD from type string[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect SEALER from filename[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect GRIPPER from type string[32m 0[2mms[22m[39m
       [32mâœ“[39m should default to OTHER for unknown tool types[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect SERVO subtype[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect PNEUMATIC subtype[32m 0[2mms[22m[39m
       [32mâœ“[39m should default to UNKNOWN subtype when unclear[32m 0[2mms[22m[39m
       [32mâœ“[39m should not set subtype for non-spot-weld tools[32m 0[2mms[22m[39m
       [32mâœ“[39m should find tool ID from "GUN ID" header[32m 0[2mms[22m[39m
       [32mâœ“[39m should find tool ID from "TOOL NAME" header[32m 0[2mms[22m[39m
       [32mâœ“[39m should find tool ID from "EQUIPMENT ID" header[32m 0[2mms[22m[39m
       [32mâœ“[39m should parse area/line/station from various header names[32m 0[2mms[22m[39m
       [32mâœ“[39m should parse partial data without crashing[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should skip rows with no tool ID[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should skip empty rows[32m 1[2mms[22m[39m
       [32mâœ“[39m should skip total rows[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle null and undefined values gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should warn when no valid tools found[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw error for workbook with no sheets[32m 2[2mms[22m[39m
       [32mâœ“[39m should throw error when no valid headers found[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw error for sheets with too few rows[32m 0[2mms[22m[39m
       [32mâœ“[39m should extract OEM model from various column names[32m 0[2mms[22m[39m
       [32mâœ“[39m should try MANUFACTURER column if MODEL not found[32m 0[2mms[22m[39m
       [32mâœ“[39m should try SUPPLIER column if MODEL and MANUFACTURER not found[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture source file name and sheet name[32m 0[2mms[22m[39m
       [32mâœ“[39m should capture row index for debugging[32m 0[2mms[22m[39m
 [32mâœ“[39m src/ingestion/__tests__/unifiedAssetLinker.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m src/ingestion/__tests__/columnRoleDetector.test.ts [2m([22m[2m46 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m src/excel/__tests__/columnProfiler.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [32mâœ“[39m src/ingestion/__tests__/workbookLoader.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 167[2mms[22m[39m
 [32mâœ“[39m src/ingestion/__tests__/fieldMatcher.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 26[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFile Classification: Ignore Filename, Use Headers[2m > [22m[2mshould detect ToolList from headers even if file is named "Budget_V1.xlsx"
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFile Classification: Ignore Filename, Use Headers[2m > [22m[2mshould detect ToolList from headers even if file is named "Budget_V1.xlsx"
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/stla_linking.test.ts[2m > [22m[2mReal-World Data Verification[2m > [22m[2mshould link Tool List metadata to Simulation Cell (Vacuum Verification)
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

 [32mâœ“[39m src/ingestion/__tests__/sheetSniffer.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 23[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Station 010 / Robot R01 Linking[2m > [22m[2mshould link Station 010 / Robot R01 from Simulation Status to Tool List
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Station 010 / Robot R01 Linking[2m > [22m[2mshould link Station 010 / Robot R01 from Simulation Status to Tool List
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/stla_linking.test.ts[2m > [22m[2mReal-World Data Verification[2m > [22m[2mshould link Tool List metadata to Simulation Cell (Vacuum Verification)
[22m[39m[Relational Linker] Linked 0/1 cells to assets

 [32mâœ“[39m src/excel/__tests__/minimal.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 3[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFile Classification: Ignore Filename, Use Headers[2m > [22m[2mshould detect SimulationStatus from headers even if file is named "Data.xlsx"
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

 [32mâœ“[39m src/ingestion/__tests__/embeddingTypes.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 19[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/stla_linking.test.ts[2m > [22m[2mReal-World Data Verification[2m > [22m[2mshould populate Employee and Supplier stores (Reference Data)
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/stla_linking.test.ts[2m > [22m[2mReal-World Data Verification[2m > [22m[2mshould populate Employee and Supplier stores (Reference Data)
[22m[39m[Ingestion] Detected Metadata file: STLA_S_ZAR Tool List.xlsx (sheet: SupplierList). Skipping for now.

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFile Classification: Ignore Filename, Use Headers[2m > [22m[2mshould detect RobotList from headers even with wrong filename
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFile Classification: Ignore Filename, Use Headers[2m > [22m[2mshould detect RobotList from headers even with wrong filename
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstderr[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Station 010 / Robot R01 Linking[2m > [22m[2mshould normalize station codes for linking ("010" â†’ "10")
[22m[39m[Ingestion] Error processing file sim.xlsx: Error: Sheet "SIMULATION" has too few rows (2). Expected at least 5 rows.
    at parseSimulationStatus (C:/Users/George/source/repos/SimPilot/src/ingestion/simulationStatusParser.ts:353:11)
    at ingestFiles (C:/Users/George/source/repos/SimPilot/src/ingestion/ingestionCoordinator.ts:224:30)
    at C:/Users/George/source/repos/SimPilot/src/ingestion/__tests__/realWorldIntegration.test.ts:124:9
    at file:///C:/Users/George/source/repos/SimPilot/node_modules/[4m@vitest[24m/runner/dist/index.js:919:20

 [31mâ¯[39m src/ingestion/__tests__/stla_linking.test.ts [2m([22m[2m2 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 105[2mms[22m[39m
[31m     [31mÃ—[31m should link Tool List metadata to Simulation Cell (Vacuum Verification)[39m[32m 67[2mms[22m[39m
[31m     [31mÃ—[31m should populate Employee and Supplier stores (Reference Data)[39m[32m 36[2mms[22m[39m
 [32mâœ“[39m src/ingestion/__tests__/dataQualityScoring.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 13[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "gun" keyword in headers
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "gun" keyword in headers
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests simulation status file with vacuum metrics
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould vacuum unmapped columns into tool metadata
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould vacuum unmapped columns into tool metadata
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "tool" keyword in headers
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "tool" keyword in headers
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould handle empty columns without errors
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests tool list with typos preserved
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould handle empty columns without errors
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "equipment" keyword in headers
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests tool list with typos preserved
[22m[39m[Relational Linker] Linked 0/3 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect ToolList from "equipment" keyword in headers
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect SimulationStatus from "1st stage sim" keyword
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould preserve special characters in metadata keys
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests robot list
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Vacuum Parser Metadata Capture[2m > [22m[2mshould preserve special characters in metadata keys
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests robot list
[22m[39m[Relational Linker] Linked 0/3 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect SimulationStatus from "robot reach" keywords
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests risers with Proyect typo
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould populate coreStore.referenceData.employees from EmployeeList sheet
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect RobotList from "fanuc order code" keyword
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mHeader Sniffing: Content Patterns[2m > [22m[2mshould detect RobotList from "fanuc order code" keyword
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould populate coreStore.referenceData.employees from EmployeeList sheet
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mResilience: Edge Cases[2m > [22m[2mshould warn but not crash on empty files
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests gun force data
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould populate coreStore.referenceData.suppliers from SupplierList sheet
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mingests gun force data
[22m[39m[Relational Linker] Linked 0/3 cells to assets

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould populate coreStore.referenceData.suppliers from SupplierList sheet
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mResilience: Edge Cases[2m > [22m[2mshould warn on unknown file types
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould handle workbook with BOTH EmployeeList and SupplierList sheets
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["PERSONS RESPONSIBLE","AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st STAGE SIM COMPLETION","FINAL DELIVERABLES COMPLETION"]

[90mstdout[2m | src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22m[2mReal-World Integration: Reference Data Population[2m > [22m[2mshould handle workbook with BOTH EmployeeList and SupplierList sheets
[22m[39m[Relational Linker] Linked 0/4 cells to assets

 [31mâ¯[39m src/ingestion/__tests__/realWorldIntegration.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 256[2mms[22m[39m
[31m     [31mÃ—[31m should link Station 010 / Robot R01 from Simulation Status to Tool List[39m[32m 72[2mms[22m[39m
[31m     [31mÃ—[31m should normalize station codes for linking ("010" â†’ "10")[39m[32m 37[2mms[22m[39m
     [32mâœ“[39m should vacuum unmapped columns into tool metadata[32m 30[2mms[22m[39m
     [32mâœ“[39m should handle empty columns without errors[32m 25[2mms[22m[39m
     [32mâœ“[39m should preserve special characters in metadata keys[32m 26[2mms[22m[39m
[31m     [31mÃ—[31m should populate coreStore.referenceData.employees from EmployeeList sheet[39m[32m 24[2mms[22m[39m
[31m     [31mÃ—[31m should populate coreStore.referenceData.suppliers from SupplierList sheet[39m[32m 20[2mms[22m[39m
[31m     [31mÃ—[31m should handle workbook with BOTH EmployeeList and SupplierList sheets[39m[32m 18[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mResilience: Edge Cases[2m > [22m[2mshould handle corrupted file gracefully
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mhandles complete multi-file ingestion
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

[90mstderr[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mResilience: Edge Cases[2m > [22m[2mshould handle corrupted file gracefully
[22m[39m[Ingestion] Error processing file corrupted.xlsx: Error: Failed to parse Excel file: Error: Unsupported ZIP file
    at readWorkbookFromExcelInput (C:/Users/George/source/repos/SimPilot/src/ingestion/excelUtils.ts:70:11)
    at ingestFiles (C:/Users/George/source/repos/SimPilot/src/ingestion/ingestionCoordinator.ts:190:24)
    at C:/Users/George/source/repos/SimPilot/src/ingestion/__tests__/ingestionCoordinator.test.ts:282:28
    at file:///C:/Users/George/source/repos/SimPilot/node_modules/[4m@vitest[24m/runner/dist/index.js:919:20

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mhandles complete multi-file ingestion
[22m[39m[Relational Linker] Linked 0/3 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Full Ingestion Pipeline[2m > [22m[2mhandles complete multi-file ingestion
[22m[39mWarnings: [
  [32m'ROW_SKIPPED: Row 3 skipped: No tool ID found in any expected columns'[39m,
  [32m'ROW_SKIPPED: Row 4 skipped: No tool ID found in any expected columns'[39m,
  [32m'PARSER_ERROR: Parser error: No valid tool rows found after parsing'[39m
]

[90mstdout[2m | src/ingestion/__tests__/ingestion_e2e.test.ts[2m > [22m[2mE2E: Edge Cases[2m > [22m[2mhandles sheet with header at row 4 (with title rows above)
[22m[39m[Parser] Header row index: 3
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","PERSONS RESPONSIBLE","ROBOT POSITION - STAGE 1","SPOT WELDS DISTRIBUTED + PROJECTED","FINAL DELIVERABLES","1st STAGE SIM COMPLETION","DCS CONFIGURED","FINAL FIXTURE COLLISION CHECK","FINAL LAYOUT INCLUDED MATCHING LAYOUT + SIM","LASER SAFETY CHECK"]

 [32mâœ“[39m src/ingestion/__tests__/ingestion_e2e.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 294[2mms[22m[39m
[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mMulti-File Ingestion[2m > [22m[2mshould merge tools from multiple equipment files
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mMulti-File Ingestion[2m > [22m[2mshould merge tools from multiple equipment files
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mMulti-File Ingestion[2m > [22m[2mshould merge data from multiple simulation files
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mMulti-File Ingestion[2m > [22m[2mshould merge data from multiple simulation files
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFallback to Filename[2m > [22m[2mshould fallback to filename detection when headers are unclear
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFallback to Filename[2m > [22m[2mshould fallback to filename detection when headers are unclear
[22m[39m[Relational Linker] Linked 0/4 cells to assets

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mFallback to Filename[2m > [22m[2mshould detect simulation status from filename when needed
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mData Source Tracking[2m > [22m[2mshould track data source as Local by default
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mData Source Tracking[2m > [22m[2mshould accept dataSource parameter
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

[90mstdout[2m | src/ingestion/__tests__/ingestionCoordinator.test.ts[2m > [22m[2mingestionCoordinator - Header Sniffing[2m > [22m[2mData Source Tracking[2m > [22m[2mshould accept fileSources mapping
[22m[39m[Parser] Header row index: 0
[Parser] Header row content: ["AREA","ASSEMBLY LINE","STATION","ROBOT","APPLICATION","1st Stage Sim","Reach Status","Coments"]

 [32mâœ“[39m src/ingestion/__tests__/ingestionCoordinator.test.ts [2m([22m[2m20 tests[22m[2m)[22m[33m 389[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 12 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/excelIngestionOrchestrator.test.ts[2m > [22mexcelIngestionOrchestrator[2m > [22mformatIngestionSummary[2m > [22mshould format result as readable text
[31m[1mAssertionError[22m: expected '=== Excel Ingestion Summary ===\n\nToâ€¦' to contain 'Total Assets: 200'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Total Assets: 200[39m
[31m+ === Excel Ingestion Summary ===[39m
[31m+[39m
[31m+ Total Assets: 0[39m
[31m+ Assets with Reuse Info: 140[39m
[31m+[39m
[31m+ Total Reuse Records: 150[39m
[31m+[39m
[31m+ By Type:[39m
[31m+   Riser: 50[39m
[31m+   TipDresser: 60[39m
[31m+   TMSGun: 40[39m
[31m+[39m
[31m+ By Status:[39m
[31m+   AVAILABLE: 80[39m
[31m+   ALLOCATED: 50[39m
[31m+   IN_USE: 20[39m
[31m+[39m
[31m+ Linking Statistics:[39m
[31m+   Matched: 140[39m
[31m+   Unmatched: 10[39m
[31m+[39m
[31m+ Errors/Warnings: 1[39m
[31m+[39m
[31m+   - Warning: some data missing[39m

[36m [2mâ¯[22m src/ingestion/__tests__/excelIngestionOrchestrator.test.ts:[2m294:23[22m[39m
    [90m292| [39m      [35mconst[39m summary [33m=[39m [34mformatIngestionSummary[39m(result)[33m;[39m
    [90m293| [39m
    [90m294| [39m      [34mexpect[39m(summary)[33m.[39m[34mtoContain[39m([32m'Total Assets: 200'[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m295| [39m      [34mexpect[39m(summary)[33m.[39m[34mtoContain[39m([32m'Total Reuse Records: 150'[39m)[33m;[39m
    [90m296| [39m      [34mexpect[39m(summary)[33m.[39m[34mtoContain[39m([32m'Riser: 50'[39m)[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/excelIngestionTypes.test.ts[2m > [22mbuildAssetKey[2m > [22mshould include station when present
[31m[1mAssertionError[22m: expected '010|stla-s|underbody|bn_b05' to be 'stla-s|underbody|bn_b05|010' // Object.is equality[39m

Expected: [32m"stla-s|underbody|bn_b05[7m|010[27m"[39m
Received: [31m"[7m010|[27mstla-s|underbody|bn_b05"[39m

[36m [2mâ¯[22m src/ingestion/__tests__/excelIngestionTypes.test.ts:[2m520:17[22m[39m
    [90m518| [39m      station[33m:[39m [32m'010'[39m
    [90m519| [39m    })
    [90m520| [39m    [34mexpect[39m(key)[33m.[39m[34mtoBe[39m([32m'stla-s|underbody|bn_b05|010'[39m)
    [90m   | [39m                [31m^[39m
    [90m521| [39m  })
    [90m522| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/excelIngestionTypes.test.ts[2m > [22mbuildAssetKey[2m > [22mshould include robot number when present
[31m[1mAssertionError[22m: expected '010|stla-s|underbody|bn_b05|r01' to be 'stla-s|underbody|bn_b05|010|r01' // Object.is equality[39m

Expected: [32m"stla-s|underbody|bn_b05|[7m010|[27mr01"[39m
Received: [31m"[7m010|[27mstla-s|underbody|bn_b05|r01"[39m

[36m [2mâ¯[22m src/ingestion/__tests__/excelIngestionTypes.test.ts:[2m531:17[22m[39m
    [90m529| [39m      robotNumber[33m:[39m [32m'R01'[39m
    [90m530| [39m    })
    [90m531| [39m    [34mexpect[39m(key)[33m.[39m[34mtoBe[39m([32m'stla-s|underbody|bn_b05|010|r01'[39m)
    [90m   | [39m                [31m^[39m
    [90m532| [39m  })
    [90m533| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/excelIngestionTypes.test.ts[2m > [22mbuildAssetKey[2m > [22mshould include asset name when present
[31m[1mAssertionError[22m: expected '010|stla-s|underbody|bn_b05|r01' to be 'stla-s|underbody|bn_b05|010|r01|wg-123' // Object.is equality[39m

Expected: [32m"stla-s|underbody|bn_b05|01[7m0|r01|wg-123[27m"[39m
Received: [31m"[7m010|[27mstla-s|underbody|bn_b05|[7mr[27m01"[39m

[36m [2mâ¯[22m src/ingestion/__tests__/excelIngestionTypes.test.ts:[2m543:17[22m[39m
    [90m541| [39m      assetName[33m:[39m [32m'WG-123'[39m
    [90m542| [39m    })
    [90m543| [39m    [34mexpect[39m(key)[33m.[39m[34mtoBe[39m([32m'stla-s|underbody|bn_b05|010|r01|wg-123'[39m)
    [90m   | [39m                [31m^[39m
    [90m544| [39m  })
    [90m545| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22mReal-World Integration: Station 010 / Robot R01 Linking[2m > [22mshould link Station 010 / Robot R01 from Simulation Status to Tool List
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/ingestion/__tests__/realWorldIntegration.test.ts:[2m85:32[22m[39m
    [90m 83| [39m            c[33m.[39mcode [33m===[39m [32m'010'[39m [33m&&[39m c[33m.[39mname[33m.[39m[34mincludes[39m([32m'R01'[39m)
    [90m 84| [39m        )
    [90m 85| [39m        [34mexpect[39m(station010Cell)[33m.[39m[34mtoBeDefined[39m()
    [90m   | [39m                               [31m^[39m
    [90m 86| [39m        [34mexpect[39m(station010Cell[33m?.[39mcode)[33m.[39m[34mtoBe[39m([32m'010'[39m)
    [90m 87| [39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22mReal-World Integration: Station 010 / Robot R01 Linking[2m > [22mshould normalize station codes for linking ("010" â†’ "10")
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/ingestion/__tests__/realWorldIntegration.test.ts:[2m134:22[22m[39m
    [90m132| [39m        [35mconst[39m tool [33m=[39m state[33m.[39massets[33m.[39m[34mfind[39m(a [33m=>[39m a[33m.[39mname [33m===[39m [32m'T-001'[39m)
    [90m133| [39m
    [90m134| [39m        [34mexpect[39m(cell)[33m.[39m[34mtoBeDefined[39m()
    [90m   | [39m                     [31m^[39m
    [90m135| [39m        [34mexpect[39m(tool)[33m.[39m[34mtoBeDefined[39m()
    [90m136| [39m        // expect(tool?.cellId).toBe(cell?.id) // Linked via normalizeâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22mReal-World Integration: Reference Data Population[2m > [22mshould populate coreStore.referenceData.employees from EmployeeList sheet
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/ingestion/__tests__/realWorldIntegration.test.ts:[2m270:54[22m[39m
    [90m268| [39m        [90m// Assert: coreStore.referenceData.employees populated[39m
    [90m269| [39m        [35mconst[39m state [33m=[39m coreStore[33m.[39m[34mgetState[39m()
    [90m270| [39m        [34mexpect[39m(state[33m.[39mreferenceData[33m.[39memployees[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)
    [90m   | [39m                                                     [31m^[39m
    [90m271| [39m
    [90m272| [39m        [90m// Verify specific employees[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22mReal-World Integration: Reference Data Population[2m > [22mshould populate coreStore.referenceData.suppliers from SupplierList sheet
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/ingestion/__tests__/realWorldIntegration.test.ts:[2m312:54[22m[39m
    [90m310| [39m        [90m// Assert: coreStore.referenceData.suppliers populated[39m
    [90m311| [39m        [35mconst[39m state [33m=[39m coreStore[33m.[39m[34mgetState[39m()
    [90m312| [39m        [34mexpect[39m(state[33m.[39mreferenceData[33m.[39msuppliers[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)
    [90m   | [39m                                                     [31m^[39m
    [90m313| [39m
    [90m314| [39m        [90m// Verify specific suppliers[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/realWorldIntegration.test.ts[2m > [22mReal-World Integration: Reference Data Population[2m > [22mshould handle workbook with BOTH EmployeeList and SupplierList sheets
[31m[1mAssertionError[22m: expected +0 to be 3 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 3[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/ingestion/__tests__/realWorldIntegration.test.ts:[2m358:54[22m[39m
    [90m356| [39m        [90m// Assert: Both reference data types populated[39m
    [90m357| [39m        [35mconst[39m state [33m=[39m coreStore[33m.[39m[34mgetState[39m()
    [90m358| [39m        [34mexpect[39m(state[33m.[39mreferenceData[33m.[39memployees[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m3[39m)
    [90m   | [39m                                                     [31m^[39m
    [90m359| [39m        [34mexpect[39m(state[33m.[39mreferenceData[33m.[39msuppliers[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m3[39m)
    [90m360| [39m    })

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/stla_linking.test.ts[2m > [22mReal-World Data Verification[2m > [22mshould link Tool List metadata to Simulation Cell (Vacuum Verification)
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m src/ingestion/__tests__/stla_linking.test.ts:[2m89:35[22m[39m
    [90m 87| [39m        // Note: The key names in metadata depend on how toolListParseâ€¦
    [90m 88| [39m        [90m// Assuming it uses the header names as keys.[39m
    [90m 89| [39m        [34mexpect[39m(cell010[33m?.[39mmetadata)[33m.[39m[34mtoBeDefined[39m()
    [90m   | [39m                                  [31m^[39m
    [90m 90| [39m        [34mexpect[39m(cell010[33m?.[39mmetadata[33m?.[39m[[32m'Sim. Leader'[39m])[33m.[39m[34mtoBe[39m([32m'Werner Hamel'[39m)
    [90m 91| [39m        [34mexpect[39m(cell010[33m?.[39mmetadata[33m?.[39m[[32m'Designer'[39m])[33m.[39m[34mtoBe[39m([32m'Designer X'[39m)

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/stla_linking.test.ts[2m > [22mReal-World Data Verification[2m > [22mshould populate Employee and Supplier stores (Reference Data)
[31m[1mAssertionError[22m: expected [] to have a length of 2 but got +0[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

[36m [2mâ¯[22m src/ingestion/__tests__/stla_linking.test.ts:[2m139:47[22m[39m
    [90m137| [39m
    [90m138| [39m        [90m// Employees[39m
    [90m139| [39m        [34mexpect[39m(state[33m.[39mreferenceData[33m.[39memployees)[33m.[39m[34mtoHaveLength[39m([34m2[39m)
    [90m   | [39m                                              [31m^[39m
    [90m140| [39m        expect(state.referenceData.employees.find(e => e.id === 'E001'â€¦
    [90m141| [39m        expect(state.referenceData.employees.find(e => e.name === 'Bobâ€¦

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/12]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m src/ingestion/__tests__/toolListParser.test.ts[2m > [22mtoolListParser - Real-World Resilience[2m > [22mResilience: Partial & Garbage Data[2m > [22mshould skip rows with no tool ID
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/ingestion/__tests__/toolListParser.test.ts:[2m305:44[22m[39m
    [90m303| [39m
    [90m304| [39m            [34mexpect[39m(result[33m.[39mtools[33m.[39mlength)[33m.[39m[34mtoBe[39m([34m2[39m)
    [90m305| [39m            [34mexpect[39m(result[33m.[39mwarnings[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)
    [90m   | [39m                                           [31m^[39m
    [90m306| [39m            [34mexpect[39m(result[33m.[39mwarnings[[34m0[39m][33m.[39mkind)[33m.[39m[34mtoBe[39m([32m'ROW_SKIPPED'[39m)
    [90m307| [39m        })

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/12]âŽ¯[22m[39m


[2m Test Files [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m14 passed[39m[22m[90m (19)[39m
[2m      Tests [22m [1m[31m12 failed[39m[22m[2m | [22m[1m[32m471 passed[39m[22m[90m (483)[39m
[2m   Start at [22m 19:55:16
[2m   Duration [22m 1.83s[2m (transform 2.55s, setup 0ms, import 5.52s, tests 1.71s, environment 441ms)[22m

